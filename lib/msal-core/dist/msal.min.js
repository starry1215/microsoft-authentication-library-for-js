/*! msal v0.2.4 2019-02-16 */
"use strict";!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Msal",[],t):"object"==typeof exports?exports.Msal=t():e.Msal=t()}(window,function(){return function(n){var r={};function o(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}return o.m=n,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=11)}([function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=function(){function a(){}return a.compareObjects=function(e,t){return!(!e||!t)&&!(!e.userIdentifier||!t.userIdentifier||e.userIdentifier!==t.userIdentifier)},a.expiresIn=function(e){return e||(e="3599"),this.now()+parseInt(e,10)},a.now=function(){return Math.round((new Date).getTime()/1e3)},a.isEmpty=function(e){return void 0===e||!e||0===e.length},a.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var n=t.JWSPayload,r=this.base64DecodeStringUrlSafe(n);return r?JSON.parse(r):null}catch(e){}return null},a.base64EncodeStringUrlSafe=function(e){return window.btoa?window.btoa(e):this.encode(e)},a.base64DecodeStringUrlSafe=function(e){return e=e.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(encodeURIComponent(window.atob(e))):decodeURIComponent(encodeURIComponent(this.decode(e)))},a.encode=function(e){var t,n,r,o,i,s,a,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",l=0;for(e=this.utf8Encode(e);l<e.length;)o=(t=e.charCodeAt(l++))>>2,i=(3&t)<<4|(n=e.charCodeAt(l++))>>4,s=(15&n)<<2|(r=e.charCodeAt(l++))>>6,a=63&r,isNaN(n)?s=a=64:isNaN(r)&&(a=64),u=u+c.charAt(o)+c.charAt(i)+c.charAt(s)+c.charAt(a);return u.replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")},a.utf8Encode=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):(127<r&&r<2048?t+=String.fromCharCode(r>>6|192):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128)),t+=String.fromCharCode(63&r|128))}return t},a.decode=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=(e=String(e).replace(/=+$/,"")).length;if(n%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(var r,o,i,s,a,c,u,l,d="",h=0;h<n;h+=4){if(r=t.indexOf(e.charAt(h)),o=t.indexOf(e.charAt(h+1)),i=t.indexOf(e.charAt(h+2)),s=t.indexOf(e.charAt(h+3)),h+2===n-1){c=(a=r<<18|o<<12|i<<6)>>16&255,u=a>>8&255,d+=String.fromCharCode(c,u);break}if(h+1===n-1){c=(a=r<<18|o<<12)>>16&255,d+=String.fromCharCode(c);break}c=(a=r<<18|o<<12|i<<6|s)>>16&255,u=a>>8&255,l=255&a,d+=String.fromCharCode(c,u,l)}return d},a.decodeJwt=function(e){if(this.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},a.deserialize=function(e){var t,n=/\+/g,r=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(n," "))},i={};for(t=r.exec(e);t;)i[o(t[1])]=o(t[2]),t=r.exec(e);return i},a.isIntersectingScopes=function(e,t){e=this.convertToLowerCase(e);for(var n=0;n<t.length;n++)if(-1<e.indexOf(t[n].toLowerCase()))return!0;return!1},a.containsScope=function(t,e){return t=this.convertToLowerCase(t),e.every(function(e){return 0<=t.indexOf(e.toString().toLowerCase())})},a.convertToLowerCase=function(e){return e.map(function(e){return e.toLowerCase()})},a.removeElement=function(e,t){return e.filter(function(e){return e!==t})},a.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},a.getLibraryVersion=function(){return"0.2.4"},a.replaceFirstPath=function(e,t){if(!t)return e;var n=this.GetUrlComponents(e),r=n.PathSegments;return 0===r.length||r[0]!==o.Constants.common&&r[0]!==o.Constants.organizations||(r[0]=t,e=n.Protocol+"//"+n.HostNameAndPort+"/"+r.join("/")),e},a.createNewGuid=function(){var e=window.crypto;if(e&&e.getRandomValues){var t=new Uint8Array(16);return e.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,a.decimalToHex(t[0])+a.decimalToHex(t[1])+a.decimalToHex(t[2])+a.decimalToHex(t[3])+"-"+a.decimalToHex(t[4])+a.decimalToHex(t[5])+"-"+a.decimalToHex(t[6])+a.decimalToHex(t[7])+"-"+a.decimalToHex(t[8])+a.decimalToHex(t[9])+"-"+a.decimalToHex(t[10])+a.decimalToHex(t[11])+a.decimalToHex(t[12])+a.decimalToHex(t[13])+a.decimalToHex(t[14])+a.decimalToHex(t[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",o=0,i="",s=0;s<36;s++)"-"!==n[s]&&"4"!==n[s]&&(o=16*Math.random()|0),"x"===n[s]?i+=r[o]:"y"===n[s]?(o&=3,i+=r[o|=8]):i+=n[s];return i},a.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),n=e.match(t);if(!n||n.length<6)throw"Valid url required";var r={Protocol:n[1],HostNameAndPort:n[4],AbsolutePath:n[5]},o=r.AbsolutePath.split("/");return o=o.filter(function(e){return e&&0<e.length}),r.PathSegments=o,r},a.CanonicalizeUri=function(e){return e&&(e=e.toLowerCase()),e&&!a.endsWith(e,"/")&&(e+="/"),e},a.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},a.checkSSO=function(e){return!(e&&(-1!==e.indexOf(o.Constants.login_hint)||-1!==e.indexOf(o.Constants.sid)))},a.constructUnifiedCacheExtraQueryParameter=function(e,t){return e?e.hasOwnProperty(o.Constants.upn)?(t=this.urlRemoveQueryStringParameter(t,o.Constants.login_hint),(t=this.urlRemoveQueryStringParameter(t,o.Constants.domain_hint))?t+"&"+o.Constants.login_hint+"="+e.upn+"&"+o.Constants.domain_hint+"="+o.Constants.organizations:"&"+o.Constants.login_hint+"="+e.upn+"&"+o.Constants.domain_hint+"="+o.Constants.organizations):(t=this.urlRemoveQueryStringParameter(t,o.Constants.domain_hint))?t+"&"+o.Constants.domain_hint+"="+o.Constants.organizations:"&"+o.Constants.domain_hint+"="+o.Constants.organizations:t},a.urlRemoveQueryStringParameter=function(e,t){if(this.isEmpty(e))return e;var n=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+&"),e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+"),e=e.replace(n,"")},a}();t.Utils=r},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return Object.defineProperty(e,"errorDescription",{get:function(){return"error_description"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"error",{get:function(){return"error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"scope",{get:function(){return"scope"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"acquireTokenUser",{get:function(){return"msal.acquireTokenUser"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clientInfo",{get:function(){return"client_info"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clientId",{get:function(){return"clientId"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"authority",{get:function(){return"msal.authority"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"idToken",{get:function(){return"id_token"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"accessToken",{get:function(){return"access_token"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"expiresIn",{get:function(){return"expires_in"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"sessionState",{get:function(){return"session_state"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"msalClientInfo",{get:function(){return"msal.client.info"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"msalError",{get:function(){return"msal.error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"msalErrorDescription",{get:function(){return"msal.error.description"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"msalSessionState",{get:function(){return"msal.session.state"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"tokenKeys",{get:function(){return"msal.token.keys"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"accessTokenKey",{get:function(){return"msal.access.token.key"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"expirationKey",{get:function(){return"msal.expiration.key"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"stateLogin",{get:function(){return"msal.state.login"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"stateAcquireToken",{get:function(){return"msal.state.acquireToken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"stateRenew",{get:function(){return"msal.state.renew"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"nonceIdToken",{get:function(){return"msal.nonce.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"userName",{get:function(){return"msal.username"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"idTokenKey",{get:function(){return"msal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"loginRequest",{get:function(){return"msal.login.request"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"loginError",{get:function(){return"msal.login.error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"renewStatus",{get:function(){return"msal.token.renew.status"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"msal",{get:function(){return"msal"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"no_user",{get:function(){return"NO_USER"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"login_hint",{get:function(){return"login_hint"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"domain_hint",{get:function(){return"domain_hint"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"organizations",{get:function(){return"organizations"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"consumers",{get:function(){return"consumers"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"consumersUtid",{get:function(){return"9188040d-6c67-4c5b-b112-36a304b66dad"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"sid",{get:function(){return"sid"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"upn",{get:function(){return"upn"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt",{get:function(){return"prompt"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"resourceDelimeter",{get:function(){return"|"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"tokenRenewStatusCancelled",{get:function(){return"Canceled"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"tokenRenewStatusCompleted",{get:function(){return"Completed"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"tokenRenewStatusInProgress",{get:function(){return"In Progress"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"login",{get:function(){return"LOGIN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"unknown",{get:function(){return"UNKNOWN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"urlHash",{get:function(){return"msal.urlHash"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"angularLoginRequest",{get:function(){return"msal.angular.login.request"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"userIdentifier",{get:function(){return"userIdentifier"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"common",{get:function(){return"common"},enumerable:!0,configurable:!0}),e._popUpWidth=483,e._popUpHeight=600,e}();t.Constants=r;var o=function(){function e(){}return Object.defineProperty(e,"loginProgressError",{get:function(){return"login_progress_error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"acquireTokenProgressError",{get:function(){return"acquiretoken_progress_error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"inputScopesError",{get:function(){return"input_scopes_error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"endpointResolutionError",{get:function(){return"endpoints_resolution_error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpWindowError",{get:function(){return"popup_window_error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"userLoginError",{get:function(){return"user_login_error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"userCancelledError",{get:function(){return"user_cancelled"},enumerable:!0,configurable:!0}),e}();t.ErrorCodes=o;var i=function(){function e(){}return Object.defineProperty(e,"loginProgressError",{get:function(){return"Login is in progress"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"acquireTokenProgressError",{get:function(){return"Acquire token is in progress"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"inputScopesError",{get:function(){return"Invalid value of input scopes provided"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"endpointResolutionError",{get:function(){return"Endpoints cannot be resolved"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpWindowError",{get:function(){return"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},enumerable:!0,configurable:!0}),Object.defineProperty(e,"userLoginError",{get:function(){return"User login is required"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"userCancelledError",{get:function(){return"User closed the popup window and cancelled the flow"},enumerable:!0,configurable:!0}),e}();t.ErrorDescription=i},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(0),i=n(5),s=n(10);(r=t.AuthorityType||(t.AuthorityType={}))[r.Aad=0]="Aad",r[r.Adfs=1]="Adfs",r[r.B2C=2]="B2C";var a=function(){function e(e,t){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri()}return Object.defineProperty(e.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),e.prototype.validateResolved=function(){if(!this.tenantDiscoveryResponse)throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(e.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=o.Utils.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=o.Utils.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),e.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(e){throw i.ErrorMessage.invalidAuthorityType}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw i.ErrorMessage.authorityUriInsecure;if(!e.PathSegments||e.PathSegments.length<1)throw i.ErrorMessage.authorityUriInvalidPath},e.prototype.DiscoverEndpoints=function(e){return(new s.XhrClient).sendRequestAsync(e,"GET",!0).then(function(e){return{AuthorizationEndpoint:e.authorization_endpoint,EndSessionEndpoint:e.end_session_endpoint,Issuer:e.issuer}})},e.prototype.ResolveEndpointsAsync=function(){var t=this,n="";return this.GetOpenIdConfigurationEndpointAsync().then(function(e){return n=e,t.DiscoverEndpoints(n)}).then(function(e){return t.tenantDiscoveryResponse=e,t})},e}();t.Authority=a},function(e,t,n){
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
Object.defineProperty(t,"__esModule",{value:!0});var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};function o(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function i(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s}function d(e){return this instanceof d?(this.v=e,this):new d(e)}t.__extends=function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},t.__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},t.__rest=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]])}return n},t.__decorate=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;0<=a;a--)(o=e[a])&&(s=(i<3?o(s):3<i?o(t,n,s):o(t,n))||s);return 3<i&&s&&Object.defineProperty(t,n,s),s},t.__param=function(n,r){return function(e,t){r(e,t,n)}},t.__metadata=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},t.__awaiter=function(i,s,a,c){return new(a||(a=Promise))(function(e,t){function n(e){try{o(c.next(e))}catch(e){t(e)}}function r(e){try{o(c.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(n,r)}o((c=c.apply(i,s||[])).next())})},t.__generator=function(n,r){var o,i,s,e,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(s=i[2&t[0]?"return":t[0]?"throw":"next"])&&!(s=s.call(i,t[1])).done)return s;switch(i=0,s&&(t=[0,s.value]),t[0]){case 0:case 1:s=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,i=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){a.label=t[1];break}if(6===t[0]&&a.label<s[1]){a.label=s[1],s=t;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(t);break}s[2]&&a.ops.pop(),a.trys.pop();continue}t=r.call(n,a)}catch(e){t=[6,e],i=0}finally{o=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},t.__exportStar=function(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])},t.__values=o,t.__read=i,t.__spread=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e},t.__await=d,t.__asyncGenerator=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,i=n.apply(e,t||[]),s=[];return o={},r("next"),r("throw"),r("return"),o[Symbol.asyncIterator]=function(){return this},o;function r(r){i[r]&&(o[r]=function(n){return new Promise(function(e,t){1<s.push([r,n,e,t])||a(r,n)})})}function a(e,t){try{(n=i[e](t)).value instanceof d?Promise.resolve(n.value.v).then(c,u):l(s[0][2],n)}catch(e){l(s[0][3],e)}var n}function c(e){a("next",e)}function u(e){a("throw",e)}function l(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}},t.__asyncDelegator=function(r){var e,o;return e={},t("next"),t("throw",function(e){throw e}),t("return"),e[Symbol.iterator]=function(){return this},e;function t(t,n){r[t]&&(e[t]=function(e){return(o=!o)?{value:d(r[t](e)),done:"return"===t}:n?n(e):e})}},t.__asyncValues=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator];return t?t.call(e):o(e)}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var c,r,i=n(0);(r=c=t.LogLevel||(t.LogLevel={}))[r.Error=0]="Error",r[r.Warning=1]="Warning",r[r.Info=2]="Info",r[r.Verbose=3]="Verbose";var o=function(){function e(e,t){void 0===t&&(t={}),this._level=c.Info;var n=t.correlationId,r=void 0===n?"":n,o=t.level,i=void 0===o?c.Info:o,s=t.piiLoggingEnabled,a=void 0!==s&&s;this._localCallback=e,this._correlationId=r,this._level=i,this._piiLoggingEnabled=a}return e.prototype.logMessage=function(e,t,n){if(!(e>this._level||!this._piiLoggingEnabled&&n)){var r,o=(new Date).toUTCString();r=i.Utils.isEmpty(this._correlationId)?o+":"+i.Utils.getLibraryVersion()+"-"+c[e]+" "+t:o+":"+this._correlationId+"-"+i.Utils.getLibraryVersion()+"-"+c[e]+" "+t,this.executeCallback(e,r,n)}},e.prototype.executeCallback=function(e,t,n){this._localCallback&&this._localCallback(e,t,n)},e.prototype.error=function(e){this.logMessage(c.Error,e,!1)},e.prototype.errorPii=function(e){this.logMessage(c.Error,e,!0)},e.prototype.warning=function(e){this.logMessage(c.Warning,e,!1)},e.prototype.warningPii=function(e){this.logMessage(c.Warning,e,!0)},e.prototype.info=function(e){this.logMessage(c.Info,e,!1)},e.prototype.infoPii=function(e){this.logMessage(c.Info,e,!0)},e.prototype.verbose=function(e){this.logMessage(c.Verbose,e,!1)},e.prototype.verbosePii=function(e){this.logMessage(c.Verbose,e,!0)},e}();t.Logger=o},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return Object.defineProperty(e,"authorityUriInvalidPath",{get:function(){return"AuthorityUriInvalidPath"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"authorityUriInsecure",{get:function(){return"AuthorityUriInsecure"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"invalidAuthorityType",{get:function(){return"InvalidAuthorityType"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"unsupportedAuthorityValidation",{get:function(){return"UnsupportedAuthorityValidation"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"b2cAuthorityUriInvalidPath",{get:function(){return"B2cAuthorityUriInvalidPath"},enumerable:!0,configurable:!0}),e}();t.ErrorMessage=r},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),f=n(13),g=n(14),m=n(15),y=n(16),O=n(1),d=n(17),R=n(4),x=n(18),s=n(7),h=n(8),C=n(0),w=n(20),_="id_token",v="token",b="id_token token",o=function(e,t,n){var r=n.value;return n.value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.isInIframe()?new Promise(function(){}):r.apply(this,e)},n},i=function(){function e(e,t,n,r){void 0===r&&(r={}),this._cacheLocations={localStorage:"localStorage",sessionStorage:"sessionStorage"},this._clockSkew=300,this._tokenReceivedCallback=null,this._isAngular=!1;var o=r.validateAuthority,i=void 0===o||o,s=r.cacheLocation,a=void 0===s?"sessionStorage":s,c=r.redirectUri,u=void 0===c?function(){return window.location.href.split("?")[0].split("#")[0]}:c,l=r.postLogoutRedirectUri,d=void 0===l?function(){return window.location.href.split("?")[0].split("#")[0]}:l,h=r.logger,p=void 0===h?new R.Logger(null):h,f=r.loadFrameTimeout,g=void 0===f?6e3:f,m=r.navigateToLoginRequestUrl,y=void 0===m||m,C=r.state,w=void 0===C?"":C,_=r.isAngular,v=void 0!==_&&_,b=r.unprotectedResources,I=void 0===b?new Array:b,k=r.protectedResourceMap,S=void 0===k?new Map:k,T=r.storeAuthStateInCookie,P=void 0!==T&&T;if(this.loadFrameTimeout=g,this.clientId=e,this.validateAuthority=i,this.authority=t||"https://login.microsoftonline.com/common",this._tokenReceivedCallback=n,this._redirectUri=u,this._postLogoutredirectUri=d,this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._cacheLocation=a,this._navigateToLoginRequestUrl=y,this._state=w,this._isAngular=v,this._unprotectedResources=I,this._protectedResourceMap=S,!this._cacheLocations[a])throw new Error("Cache Location is not valid. Provided value:"+this._cacheLocation+".Possible values are: "+this._cacheLocations.localStorage+", "+this._cacheLocations.sessionStorage);this._cacheStorage=new x.Storage(this._cacheLocation),this._logger=p,this.storeAuthStateInCookie=P,window.openedWindows=[],window.activeRenewals={},window.renewStates=[],window.callBackMappedToRenewStates={},window.callBacksMappedToRenewStates={},window.msal=this;var A=window.location.hash,U=this.isCallback(A);if(!this._isAngular)if(U)this.handleAuthenticationResponse.call(this,A);else{var E=this._cacheStorage.getItem(O.Constants.urlHash);E&&this.processCallBack(E)}}return Object.defineProperty(e.prototype,"cacheLocation",{get:function(){return this._cacheLocation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=w.AuthorityFactory.CreateInstance(e,this.validateAuthority)},enumerable:!0,configurable:!0}),e.prototype.processCallBack=function(e){this._logger.info("Processing the callback from redirect response");var t=this.getRequestInfo(e);this.saveTokenFromHash(t);var n,r=t.parameters[O.Constants.accessToken]||t.parameters[O.Constants.idToken],o=t.parameters[O.Constants.errorDescription],i=t.parameters[O.Constants.error];n=t.parameters[O.Constants.accessToken]?O.Constants.accessToken:O.Constants.idToken,this._cacheStorage.removeItem(O.Constants.urlHash);try{this._tokenReceivedCallback&&(this._cacheStorage.clearCookie(),this._tokenReceivedCallback.call(this,o,r,i,n,this.getUserState(this._cacheStorage.getItem(O.Constants.stateLogin,this.storeAuthStateInCookie))))}catch(e){this._logger.error("Error occurred in token received callback function: "+e)}},e.prototype.getRedirectUri=function(){return"function"==typeof this._redirectUri?this._redirectUri():this._redirectUri},e.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this._postLogoutredirectUri?this._postLogoutredirectUri():this._postLogoutredirectUri},e.prototype.loginRedirect=function(t,n){var r=this;if(this._loginInProgress&&this._tokenReceivedCallback)this._tokenReceivedCallback(O.ErrorDescription.loginProgressError,null,O.ErrorCodes.loginProgressError,O.Constants.idToken,this.getUserState(this._cacheStorage.getItem(O.Constants.stateLogin,this.storeAuthStateInCookie)));else{if(t){var e=this.validateInputScope(t);if(e&&!C.Utils.isEmpty(e)&&this._tokenReceivedCallback)return void this._tokenReceivedCallback(O.ErrorDescription.inputScopesError,null,O.ErrorCodes.inputScopesError,O.Constants.idToken,this.getUserState(this._cacheStorage.getItem(O.Constants.stateLogin,this.storeAuthStateInCookie)));t=this.filterScopes(t)}var o;(o=this.extractADALIdToken())&&!t?(this._logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken "),n=C.Utils.constructUnifiedCacheExtraQueryParameter(o,n),this._silentLogin=!0,this.acquireTokenSilent([this.clientId],this.authority,this.getUser(),n).then(function(e){r._silentLogin=!1,r._logger.info("Unified cache call is successful"),r._tokenReceivedCallback&&r._tokenReceivedCallback.call(r,null,e,null,O.Constants.idToken,r.getUserState(r._silentAuthenticationState))},function(e){r._silentLogin=!1,r._logger.error("Error occurred during unified cache ATS"),r.loginRedirectHelper(t,n)})):this.loginRedirectHelper(t,n)}},e.prototype.loginRedirectHelper=function(o,i){var s=this;this._loginInProgress=!0,this.authorityInstance.ResolveEndpointsAsync().then(function(){var e=new m.AuthenticationRequestParameters(s.authorityInstance,s.clientId,o,_,s.getRedirectUri(),s._state);i&&(e.extraQueryParameters=i);var t=s._cacheStorage.getItem(O.Constants.angularLoginRequest);t&&""!==t?s._cacheStorage.setItem(O.Constants.angularLoginRequest,""):t=window.location.href,s._cacheStorage.setItem(O.Constants.loginRequest,t,s.storeAuthStateInCookie),s._cacheStorage.setItem(O.Constants.loginError,""),s._cacheStorage.setItem(O.Constants.stateLogin,e.state,s.storeAuthStateInCookie),s._cacheStorage.setItem(O.Constants.nonceIdToken,e.nonce,s.storeAuthStateInCookie),s._cacheStorage.setItem(O.Constants.msalError,""),s._cacheStorage.setItem(O.Constants.msalErrorDescription,"");var n=O.Constants.authority+O.Constants.resourceDelimeter+e.state;s._cacheStorage.setItem(n,s.authority,s.storeAuthStateInCookie);var r=e.createNavigateUrl(o)+O.Constants.response_mode_fragment;s.promptUser(r)})},e.prototype.loginPopup=function(o,i){var s=this;return new Promise(function(t,n){if(s._loginInProgress)n(O.ErrorCodes.loginProgressError+O.Constants.resourceDelimeter+O.ErrorDescription.loginProgressError);else{if(o){var e=s.validateInputScope(o);if(e&&!C.Utils.isEmpty(e))return void n(O.ErrorCodes.inputScopesError+O.Constants.resourceDelimeter+O.ErrorDescription.inputScopesError);o=s.filterScopes(o)}var r;(r=s.extractADALIdToken())&&!o?(s._logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken "),i=C.Utils.constructUnifiedCacheExtraQueryParameter(r,i),s._silentLogin=!0,s.acquireTokenSilent([s.clientId],s.authority,s.getUser(),i).then(function(e){s._silentLogin=!1,s._logger.info("Unified cache call is successful"),t(e)},function(e){s._silentLogin=!1,s._logger.error("Error occurred during unified cache ATS"),s.loginPopupHelper(t,n,o,i)})):s.loginPopupHelper(t,n,o,i)}})},e.prototype.loginPopupHelper=function(r,o,i,s){var a=this;i||(i=[this.clientId]);var c=i.join(" ").toLowerCase(),u=this.openWindow("about:blank","_blank",1,this,r,o);u&&(this._loginInProgress=!0,this.authorityInstance.ResolveEndpointsAsync().then(function(){var e=new m.AuthenticationRequestParameters(a.authorityInstance,a.clientId,i,_,a.getRedirectUri(),a._state);s&&(e.extraQueryParameters=s),a._cacheStorage.setItem(O.Constants.loginRequest,window.location.href,a.storeAuthStateInCookie),a._cacheStorage.setItem(O.Constants.loginError,""),a._cacheStorage.setItem(O.Constants.nonceIdToken,e.nonce,a.storeAuthStateInCookie),a._cacheStorage.setItem(O.Constants.msalError,""),a._cacheStorage.setItem(O.Constants.msalErrorDescription,"");var t=O.Constants.authority+O.Constants.resourceDelimeter+e.state;a._cacheStorage.setItem(t,a.authority,a.storeAuthStateInCookie);var n=e.createNavigateUrl(i)+O.Constants.response_mode_fragment;window.renewStates.push(e.state),window.requestType=O.Constants.login,a.registerCallback(e.state,c,r,o),u&&(a._logger.infoPii("Navigated Popup window to:"+n),u.location.href=n)},function(){a._logger.info(O.ErrorCodes.endpointResolutionError+":"+O.ErrorDescription.endpointResolutionError),a._cacheStorage.setItem(O.Constants.msalError,O.ErrorCodes.endpointResolutionError),a._cacheStorage.setItem(O.Constants.msalErrorDescription,O.ErrorDescription.endpointResolutionError),o&&o(O.ErrorCodes.endpointResolutionError+":"+O.ErrorDescription.endpointResolutionError),u&&u.close()}).catch(function(e){a._logger.warning("could not resolve endpoints"),o(e)}))},e.prototype.promptUser=function(e){e&&!C.Utils.isEmpty(e)?(this._logger.infoPii("Navigate to:"+e),window.location.replace(e)):this._logger.info("Navigate url is empty")},e.prototype.openWindow=function(e,t,n,r,o,i){var s=this,a=this.openPopup(e,t,O.Constants.popUpWidth,O.Constants.popUpHeight);if(null==a)return r._loginInProgress=!1,r._acquireTokenInProgress=!1,this._logger.info(O.ErrorCodes.popUpWindowError+":"+O.ErrorDescription.popUpWindowError),this._cacheStorage.setItem(O.Constants.msalError,O.ErrorCodes.popUpWindowError),this._cacheStorage.setItem(O.Constants.msalErrorDescription,O.ErrorDescription.popUpWindowError),i&&i(O.ErrorCodes.popUpWindowError+O.Constants.resourceDelimeter+O.ErrorDescription.popUpWindowError),null;window.openedWindows.push(a);var c=window.setInterval(function(){if(a&&a.closed&&r._loginInProgress){if(i&&i(O.ErrorCodes.userCancelledError+O.Constants.resourceDelimeter+O.ErrorDescription.userCancelledError),window.clearInterval(c),s._isAngular)return void s.broadcast("msal:popUpClosed",O.ErrorCodes.userCancelledError+O.Constants.resourceDelimeter+O.ErrorDescription.userCancelledError);r._loginInProgress=!1,r._acquireTokenInProgress=!1}try{var e=a.location;if(-1!==e.href.indexOf(s.getRedirectUri())&&(window.clearInterval(c),r._loginInProgress=!1,r._acquireTokenInProgress=!1,s._logger.info("Closing popup window"),s._isAngular)){s.broadcast("msal:popUpHashChanged",e.hash);for(var t=0;t<window.openedWindows.length;t++)window.openedWindows[t].close()}}catch(e){}},n);return a},e.prototype.broadcast=function(e,t){var n=new CustomEvent(e,{detail:t});window.dispatchEvent(n)},e.prototype.logout=function(){this.clearCache(),this._user=null;var e="";this.getPostLogoutRedirectUri()&&(e="post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri()));var t=this.authority+"/oauth2/v2.0/logout?"+e;this.promptUser(t)},e.prototype.clearCache=function(){window.renewStates=[];for(var e=this._cacheStorage.getAllAccessTokens(O.Constants.clientId,O.Constants.userIdentifier),t=0;t<e.length;t++)this._cacheStorage.removeItem(JSON.stringify(e[t].key));this._cacheStorage.resetCacheItems(),this._cacheStorage.clearCookie()},e.prototype.clearCacheForScope=function(e){for(var t=this._cacheStorage.getAllAccessTokens(O.Constants.clientId,O.Constants.userIdentifier),n=0;n<t.length;n++){var r=t[n];r.value.accessToken===e&&this._cacheStorage.removeItem(JSON.stringify(r.key))}},e.prototype.openPopup=function(e,t,n,r){try{var o=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=s/2-n/2+o,u=a/2-r/2+i,l=window.open(e,t,"width="+n+", height="+r+", top="+u+", left="+c);return l.focus&&l.focus(),l}catch(e){return this._logger.error("error opening popup "+e.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},e.prototype.validateInputScope=function(e){if(!e||e.length<1)return"Scopes cannot be passed as an empty array";if(!Array.isArray(e))throw new Error("API does not accept non-array scopes");return-1<e.indexOf(this.clientId)&&1<e.length?"ClientId can only be provided as a single scope":""},e.prototype.filterScopes=function(e){return e=(e=e.filter(function(e){return"openid"!==e})).filter(function(e){return"profile"!==e})},e.prototype.registerCallback=function(i,s,e,t){var a=this;window.activeRenewals[s]=i,window.callBacksMappedToRenewStates[i]||(window.callBacksMappedToRenewStates[i]=[]),window.callBacksMappedToRenewStates[i].push({resolve:e,reject:t}),window.callBackMappedToRenewStates[i]||(window.callBackMappedToRenewStates[i]=function(e,t,n,r){window.activeRenewals[s]=null;for(var o=0;o<window.callBacksMappedToRenewStates[i].length;++o)try{e||n?window.callBacksMappedToRenewStates[i][o].reject(e+O.Constants.resourceDelimeter+n):t&&window.callBacksMappedToRenewStates[i][o].resolve(t)}catch(e){a._logger.warning(e)}window.callBacksMappedToRenewStates[i]=null,window.callBackMappedToRenewStates[i]=null})},e.prototype.getCachedTokenInternal=function(e,t){var n,r=t||this.getUser();if(!r)return null;var o=this.authorityInstance?this.authorityInstance:w.AuthorityFactory.CreateInstance(this.authority,this.validateAuthority);return n=C.Utils.compareObjects(r,this.getUser())?-1<e.indexOf(this.clientId)?new m.AuthenticationRequestParameters(o,this.clientId,e,_,this.getRedirectUri(),this._state):new m.AuthenticationRequestParameters(o,this.clientId,e,v,this.getRedirectUri(),this._state):new m.AuthenticationRequestParameters(o,this.clientId,e,b,this.getRedirectUri(),this._state),this.getCachedToken(n,t)},e.prototype.getCachedToken=function(e,t){var n=null,r=e.scopes,o=this._cacheStorage.getAllAccessTokens(this.clientId,t?t.userIdentifier:null);if(0===o.length)return null;var i=[];if(e.authority){for(s=0;s<o.length;s++){c=(a=o[s]).key.scopes.split(" ");C.Utils.containsScope(c,r)&&a.key.authority===e.authority&&i.push(a)}if(0===i.length)return null;if(1!==i.length)return{errorDesc:"The cache contains multiple tokens satisfying the requirements.Call AcquireToken again providing more requirements like authority",token:null,error:"multiple_matching_tokens_detected"};n=i[0]}else{for(var s=0;s<o.length;s++){var a,c=(a=o[s]).key.scopes.split(" ");C.Utils.containsScope(c,r)&&i.push(a)}if(1===i.length)n=i[0],e.authorityInstance=w.AuthorityFactory.CreateInstance(n.key.authority,this.validateAuthority);else{if(1<i.length)return{errorDesc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements like authority",token:null,error:"multiple_matching_tokens_detected"};var u=this.getUniqueAuthority(o,"authority");if(1<u.length)return{errorDesc:"Multiple authorities found in the cache. Pass authority in the API overload.",token:null,error:"multiple_matching_tokens_detected"};e.authorityInstance=w.AuthorityFactory.CreateInstance(u[0],this.validateAuthority)}}if(null==n)return null;var l=Number(n.value.expiresIn),d=this._clockSkew||300;return l&&l>C.Utils.now()+d?{errorDesc:null,token:n.value.accessToken,error:null}:(this._cacheStorage.removeItem(JSON.stringify(i[0].key)),null)},e.prototype.getAllUsers=function(){for(var e=[],t=this._cacheStorage.getAllAccessTokens(O.Constants.clientId,O.Constants.userIdentifier),n=0;n<t.length;n++){var r=new d.IdToken(t[n].value.idToken),o=new y.ClientInfo(t[n].value.clientInfo),i=h.User.createUser(r,o);e.push(i)}return this.getUniqueUsers(e)},e.prototype.getUniqueUsers=function(e){if(!e||e.length<=1)return e;for(var t=[],n=[],r=0;r<e.length;++r)e[r].userIdentifier&&-1===t.indexOf(e[r].userIdentifier)&&(t.push(e[r].userIdentifier),n.push(e[r]));return n},e.prototype.getUniqueAuthority=function(e,t){var n=[],r=[];return e.forEach(function(e){e.key.hasOwnProperty(t)&&-1===r.indexOf(e.key[t])&&(r.push(e.key[t]),n.push(e.key[t]))}),n},e.prototype.addHintParameters=function(e,t){var n=t||this.getUser();if(n){var r=n.userIdentifier.split("."),o=C.Utils.base64DecodeStringUrlSafe(r[0]),i=C.Utils.base64DecodeStringUrlSafe(r[1]);n.sid&&-1!==e.indexOf(O.Constants.prompt_none)?this.urlContainsQueryStringParameter(O.Constants.sid,e)||this.urlContainsQueryStringParameter(O.Constants.login_hint,e)||(e+="&"+O.Constants.sid+"="+encodeURIComponent(n.sid)):this.urlContainsQueryStringParameter(O.Constants.login_hint,e)||!n.displayableId||C.Utils.isEmpty(n.displayableId)||(e+="&"+O.Constants.login_hint+"="+encodeURIComponent(n.displayableId)),C.Utils.isEmpty(o)||C.Utils.isEmpty(i)||(this.urlContainsQueryStringParameter("domain_req",e)||C.Utils.isEmpty(i)||(e+="&domain_req="+encodeURIComponent(i)),this.urlContainsQueryStringParameter("login_req",e)||C.Utils.isEmpty(o)||(e+="&login_req="+encodeURIComponent(o))),this.urlContainsQueryStringParameter(O.Constants.domain_hint,e)||C.Utils.isEmpty(i)||(i===O.Constants.consumersUtid?e+="&"+O.Constants.domain_hint+"="+encodeURIComponent(O.Constants.consumers):e+="&"+O.Constants.domain_hint+"="+encodeURIComponent(O.Constants.organizations))}return e},e.prototype.urlContainsQueryStringParameter=function(e,t){return new RegExp("[\\?&]"+e+"=").test(t)},e.prototype.acquireTokenRedirect=function(r,e,t,o){var i=this,n=this.validateInputScope(r);if(n&&!C.Utils.isEmpty(n)&&this._tokenReceivedCallback)this._tokenReceivedCallback(O.ErrorDescription.inputScopesError,null,O.ErrorCodes.inputScopesError,O.Constants.accessToken,this.getUserState(this._cacheStorage.getItem(O.Constants.stateLogin,this.storeAuthStateInCookie)));else{r&&(r=this.filterScopes(r));var s=t||this.getUser();if(!this._acquireTokenInProgress){var a;r.join(" ").toLowerCase();if(!(s||o&&-1!==o.indexOf(O.Constants.login_hint))&&this._tokenReceivedCallback)return this._logger.info("User login is required"),void this._tokenReceivedCallback(O.ErrorDescription.userLoginError,null,O.ErrorCodes.userLoginError,O.Constants.accessToken,this.getUserState(this._cacheStorage.getItem(O.Constants.stateLogin,this.storeAuthStateInCookie)));this._acquireTokenInProgress=!0;var c=e?w.AuthorityFactory.CreateInstance(e,this.validateAuthority):this.authorityInstance;c.ResolveEndpointsAsync().then(function(){var e;a=C.Utils.compareObjects(s,i.getUser())?-1<r.indexOf(i.clientId)?new m.AuthenticationRequestParameters(c,i.clientId,r,_,i.getRedirectUri(),i._state):new m.AuthenticationRequestParameters(c,i.clientId,r,v,i.getRedirectUri(),i._state):new m.AuthenticationRequestParameters(c,i.clientId,r,b,i.getRedirectUri(),i._state),i._cacheStorage.setItem(O.Constants.nonceIdToken,a.nonce,i.storeAuthStateInCookie),e=s?O.Constants.acquireTokenUser+O.Constants.resourceDelimeter+s.userIdentifier+O.Constants.resourceDelimeter+a.state:O.Constants.acquireTokenUser+O.Constants.resourceDelimeter+O.Constants.no_user+O.Constants.resourceDelimeter+a.state,i._cacheStorage.setItem(e,JSON.stringify(s));var t=O.Constants.authority+O.Constants.resourceDelimeter+a.state;i._cacheStorage.setItem(t,c.CanonicalAuthority,i.storeAuthStateInCookie),o&&(a.extraQueryParameters=o);var n=a.createNavigateUrl(r)+O.Constants.response_mode_fragment;(n=i.addHintParameters(n,s))&&(i._cacheStorage.setItem(O.Constants.stateAcquireToken,a.state,i.storeAuthStateInCookie),window.location.replace(n))})}}},e.prototype.acquireTokenPopup=function(l,t,n,d){var h=this;return new Promise(function(r,o){var e=h.validateInputScope(l);e&&!C.Utils.isEmpty(e)&&o(O.ErrorCodes.inputScopesError+O.Constants.resourceDelimeter+e),l&&(l=h.filterScopes(l));var i=n||h.getUser();if(h._acquireTokenInProgress)o(O.ErrorCodes.acquireTokenProgressError+O.Constants.resourceDelimeter+O.ErrorDescription.acquireTokenProgressError);else{var s,a=l.join(" ").toLowerCase();if(!(i||d&&-1!==d.indexOf(O.Constants.login_hint)))return h._logger.info("User login is required"),void o(O.ErrorCodes.userLoginError+O.Constants.resourceDelimeter+O.ErrorDescription.userLoginError);h._acquireTokenInProgress=!0;var c=t?w.AuthorityFactory.CreateInstance(t,h.validateAuthority):h.authorityInstance,u=h.openWindow("about:blank","_blank",1,h,r,o);u&&c.ResolveEndpointsAsync().then(function(){var e;s=C.Utils.compareObjects(i,h.getUser())?-1<l.indexOf(h.clientId)?new m.AuthenticationRequestParameters(c,h.clientId,l,_,h.getRedirectUri(),h._state):new m.AuthenticationRequestParameters(c,h.clientId,l,v,h.getRedirectUri(),h._state):new m.AuthenticationRequestParameters(c,h.clientId,l,b,h.getRedirectUri(),h._state),h._cacheStorage.setItem(O.Constants.nonceIdToken,s.nonce),s.state=s.state,e=i?O.Constants.acquireTokenUser+O.Constants.resourceDelimeter+i.userIdentifier+O.Constants.resourceDelimeter+s.state:O.Constants.acquireTokenUser+O.Constants.resourceDelimeter+O.Constants.no_user+O.Constants.resourceDelimeter+s.state,h._cacheStorage.setItem(e,JSON.stringify(i));var t=O.Constants.authority+O.Constants.resourceDelimeter+s.state;h._cacheStorage.setItem(t,c.CanonicalAuthority,h.storeAuthStateInCookie),d&&(s.extraQueryParameters=d);var n=s.createNavigateUrl(l)+O.Constants.response_mode_fragment;n=h.addHintParameters(n,i),window.renewStates.push(s.state),window.requestType=O.Constants.renewToken,h.registerCallback(s.state,a,r,o),u&&(u.location.href=n)},function(){h._logger.info(O.ErrorCodes.endpointResolutionError+":"+O.ErrorDescription.endpointResolutionError),h._cacheStorage.setItem(O.Constants.msalError,O.ErrorCodes.endpointResolutionError),h._cacheStorage.setItem(O.Constants.msalErrorDescription,O.ErrorDescription.endpointResolutionError),o&&o(O.ErrorCodes.endpointResolutionError+O.Constants.resourceDelimeter+O.ErrorDescription.endpointResolutionError),u&&u.close()}).catch(function(e){h._logger.warning("could not resolve endpoints"),o(e)})}})},e.prototype.acquireTokenSilent=function(u,l,d,h){var p=this;return new Promise(function(e,t){var n=p.validateInputScope(u);if(n&&!C.Utils.isEmpty(n))return t(O.ErrorCodes.inputScopesError+"|"+n),null;u&&(u=p.filterScopes(u));var r,o=u.join(" ").toLowerCase(),i=d||p.getUser(),s=p._cacheStorage.getItem(O.Constants.adalIdToken);if(!i&&C.Utils.checkSSO(h)&&C.Utils.isEmpty(s))return p._logger.info("User login is required"),t(O.ErrorCodes.userLoginError+O.Constants.resourceDelimeter+O.ErrorDescription.userLoginError),null;if(!i&&!C.Utils.isEmpty(s)){var a=C.Utils.extractIdToken(s);console.log("ADAL's idToken exists. Extracting login information from ADAL's idToken "),h=C.Utils.constructUnifiedCacheExtraQueryParameter(a,h)}r=C.Utils.compareObjects(i,p.getUser())?-1<u.indexOf(p.clientId)?new m.AuthenticationRequestParameters(w.AuthorityFactory.CreateInstance(l,p.validateAuthority),p.clientId,u,_,p.getRedirectUri(),p._state):new m.AuthenticationRequestParameters(w.AuthorityFactory.CreateInstance(l,p.validateAuthority),p.clientId,u,v,p.getRedirectUri(),p._state):-1<u.indexOf(p.clientId)?new m.AuthenticationRequestParameters(w.AuthorityFactory.CreateInstance(l,p.validateAuthority),p.clientId,u,_,p.getRedirectUri(),p._state):new m.AuthenticationRequestParameters(w.AuthorityFactory.CreateInstance(l,p.validateAuthority),p.clientId,u,b,p.getRedirectUri(),p._state);var c=p.getCachedToken(r,i);if(c){if(c.token)return p._logger.info("Token is already in cache for scope:"+o),e(c.token),null;if(c.errorDesc||c.error)return p._logger.infoPii(c.errorDesc+":"+c.error),t(c.errorDesc+O.Constants.resourceDelimeter+c.error),null}else p._logger.verbose("Token is not in cache for scope:"+o);return r.authorityInstance||(r.authorityInstance=l?w.AuthorityFactory.CreateInstance(l,p.validateAuthority):p.authorityInstance),r.authorityInstance.ResolveEndpointsAsync().then(function(){window.activeRenewals[o]?(p._logger.verbose("Renew token for scope: "+o+" is in progress. Registering callback"),p.registerCallback(window.activeRenewals[o],o,e,t)):u&&-1<u.indexOf(p.clientId)&&1===u.length?(p._logger.verbose("renewing idToken"),p.renewIdToken(u,e,t,i,r,h)):(p._logger.verbose("renewing accesstoken"),p.renewToken(u,e,t,i,r,h))}).catch(function(e){return p._logger.warning("could not resolve endpoints"),t(e),null})})},e.prototype.extractADALIdToken=function(){var e=this._cacheStorage.getItem(O.Constants.adalIdToken);return C.Utils.isEmpty(e)?null:C.Utils.extractIdToken(e)},e.prototype.loadIframeTimeout=function(e,t,n){var r=this,o=window.activeRenewals[n];this._logger.verbose("Set loading state to pending for: "+n+":"+o),this._cacheStorage.setItem(O.Constants.renewStatus+o,O.Constants.tokenRenewStatusInProgress),this.loadFrame(e,t),setTimeout(function(){r._cacheStorage.getItem(O.Constants.renewStatus+o)===O.Constants.tokenRenewStatusInProgress&&(r._logger.verbose("Loading frame has timed out after: "+r.loadFrameTimeout/1e3+" seconds for scope "+n+":"+o),o&&window.callBackMappedToRenewStates[o]&&window.callBackMappedToRenewStates[o]("Token renewal operation failed due to timeout",null,"Token Renewal Failed",O.Constants.accessToken),r._cacheStorage.setItem(O.Constants.renewStatus+o,O.Constants.tokenRenewStatusCancelled))},this.loadFrameTimeout)},e.prototype.loadFrame=function(t,n){var r=this;this._logger.info("LoadFrame: "+n);var o=n;setTimeout(function(){var e=r.addAdalFrame(o);""!==e.src&&"about:blank"!==e.src||(e.src=t,r._logger.infoPii("Frame Name : "+n+" Navigated to: "+t))},500)},e.prototype.addAdalFrame=function(e){if(void 0===e)return null;this._logger.info("Add msal frame to document:"+e);var t=document.getElementById(e);if(!t){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var n=document.createElement("iframe");n.setAttribute("id",e),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",t=document.getElementsByTagName("body")[0].appendChild(n)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+e+"' id='"+e+"' style='display:none'></iframe>");window.frames&&window.frames[e]&&(t=window.frames[e])}return t},e.prototype.renewToken=function(e,t,n,r,o,i){var s=e.join(" ").toLowerCase();this._logger.verbose("renewToken is called for scope:"+s);var a,c=this.addAdalFrame("msalRenewFrame"+s);i&&(o.extraQueryParameters=i),a=r?O.Constants.acquireTokenUser+O.Constants.resourceDelimeter+r.userIdentifier+O.Constants.resourceDelimeter+o.state:O.Constants.acquireTokenUser+O.Constants.resourceDelimeter+O.Constants.no_user+O.Constants.resourceDelimeter+o.state,this._cacheStorage.setItem(a,JSON.stringify(r));var u=O.Constants.authority+O.Constants.resourceDelimeter+o.state;this._cacheStorage.setItem(u,o.authority),this._cacheStorage.setItem(O.Constants.nonceIdToken,o.nonce),this._logger.verbose("Renew token Expected state: "+o.state);var l=C.Utils.urlRemoveQueryStringParameter(o.createNavigateUrl(e),O.Constants.prompt)+O.Constants.prompt_none;l=this.addHintParameters(l,r),window.renewStates.push(o.state),window.requestType=O.Constants.renewToken,this.registerCallback(o.state,s,t,n),this._logger.infoPii("Navigate to:"+l),c.src="about:blank",this.loadIframeTimeout(l,"msalRenewFrame"+s,s)},e.prototype.renewIdToken=function(e,t,n,r,o,i){e.join(" ").toLowerCase();this._logger.info("renewidToken is called");var s,a=this.addAdalFrame("msalIdTokenFrame");i&&(o.extraQueryParameters=i),s=r?O.Constants.acquireTokenUser+O.Constants.resourceDelimeter+r.userIdentifier+O.Constants.resourceDelimeter+o.state:O.Constants.acquireTokenUser+O.Constants.resourceDelimeter+O.Constants.no_user+O.Constants.resourceDelimeter+o.state,this._cacheStorage.setItem(s,JSON.stringify(r));var c=O.Constants.authority+O.Constants.resourceDelimeter+o.state;this._cacheStorage.setItem(c,o.authority),this._cacheStorage.setItem(O.Constants.nonceIdToken,o.nonce),this._logger.verbose("Renew Idtoken Expected state: "+o.state);var u=C.Utils.urlRemoveQueryStringParameter(o.createNavigateUrl(e),O.Constants.prompt)+O.Constants.prompt_none;u=this.addHintParameters(u,r),this._silentLogin?(window.requestType=O.Constants.login,this._silentAuthenticationState=o.state):(window.requestType=O.Constants.renewToken,window.renewStates.push(o.state)),this.registerCallback(o.state,this.clientId,t,n),this._logger.infoPii("Navigate to:"+u),a.src="about:blank",this.loadIframeTimeout(u,"msalIdTokenFrame",this.clientId)},e.prototype.getUser=function(){if(this._user)return this._user;var e=this._cacheStorage.getItem(O.Constants.idTokenKey),t=this._cacheStorage.getItem(O.Constants.msalClientInfo);if(C.Utils.isEmpty(e)||C.Utils.isEmpty(t))return null;var n=new d.IdToken(e),r=new y.ClientInfo(t);return this._user=h.User.createUser(n,r),this._user},e.prototype.handleAuthenticationResponse=function(e){null==e&&(e=window.location.hash);var t=null,n=!1,r=!1;try{r=window.opener&&window.opener.msal&&window.opener.msal!==window.msal}catch(e){r=!1}r?(t=window.opener.msal,n=!0):window.parent&&window.parent.msal&&(t=window.parent.msal);var o,i=t.getRequestInfo(e),s=null,a=null;if(t._logger.info("Returned from redirect url"),window.parent!==window&&window.parent.msal)a=window.parent.callBackMappedToRenewStates[i.stateResponse];else if(r)a=window.opener.callBackMappedToRenewStates[i.stateResponse];else{if(t._navigateToLoginRequestUrl)return a=null,t._cacheStorage.setItem(O.Constants.urlHash,e),!1,void(window.parent!==window||n||(window.location.href=t._cacheStorage.getItem(O.Constants.loginRequest,this.storeAuthStateInCookie)));a=t._tokenReceivedCallback,window.location.hash=""}t.saveTokenFromHash(i),i.requestType===O.Constants.renewToken&&window.parent?(window.parent!==window?t._logger.verbose("Window is in iframe, acquiring token silently"):t._logger.verbose("acquiring token interactive in progress"),s=i.parameters[O.Constants.accessToken]||i.parameters[O.Constants.idToken],o=O.Constants.accessToken):i.requestType===O.Constants.login&&(s=i.parameters[O.Constants.idToken],o=O.Constants.idToken);var c=i.parameters[O.Constants.errorDescription],u=i.parameters[O.Constants.error];try{a&&(i.stateMatch?a.call(t,c,s,u,o,this.getUserState(i.stateResponse)):a.call(t,c,s,u,o,null))}catch(e){t._logger.error("Error occurred in token received callback function: "+e)}if(r)for(var l=0;l<window.opener.openedWindows.length;l++)window.opener.openedWindows[l].close()},e.prototype.saveAccessToken=function(e,t,n,r,o){var i,s=new y.ClientInfo(r);if(t.parameters.hasOwnProperty("scope")){for(var a=(i=t.parameters.scope).split(" "),c=this._cacheStorage.getAllAccessTokens(this.clientId,e),u=0;u<c.length;u++){var l=c[u];if(l.key.userIdentifier===n.userIdentifier){var d=l.key.scopes.split(" ");C.Utils.isIntersectingScopes(d,a)&&this._cacheStorage.removeItem(JSON.stringify(l.key))}}var h=new f.AccessTokenKey(e,this.clientId,i,s.uid,s.utid),p=new g.AccessTokenValue(t.parameters[O.Constants.accessToken],o.rawIdToken,C.Utils.expiresIn(t.parameters[O.Constants.expiresIn]).toString(),r);this._cacheStorage.setItem(JSON.stringify(h),JSON.stringify(p))}else{i=this.clientId;h=new f.AccessTokenKey(e,this.clientId,i,s.uid,s.utid),p=new g.AccessTokenValue(t.parameters[O.Constants.idToken],t.parameters[O.Constants.idToken],o.expiration,r);this._cacheStorage.setItem(JSON.stringify(h),JSON.stringify(p))}},e.prototype.saveTokenFromHash=function(e){this._logger.info("State status:"+e.stateMatch+"; Request type:"+e.requestType),this._cacheStorage.setItem(O.Constants.msalError,""),this._cacheStorage.setItem(O.Constants.msalErrorDescription,"");var t="",n="";if(e.parameters.hasOwnProperty("scope")?e.parameters.scope.toLowerCase():this.clientId,e.parameters.hasOwnProperty(O.Constants.errorDescription)||e.parameters.hasOwnProperty(O.Constants.error)){if(this._logger.infoPii("Error :"+e.parameters[O.Constants.error]+"; Error description:"+e.parameters[O.Constants.errorDescription]),this._cacheStorage.setItem(O.Constants.msalError,e.parameters.error),this._cacheStorage.setItem(O.Constants.msalErrorDescription,e.parameters[O.Constants.errorDescription]),e.requestType===O.Constants.login&&(this._loginInProgress=!1,this._cacheStorage.setItem(O.Constants.loginError,e.parameters[O.Constants.errorDescription]+":"+e.parameters[O.Constants.error]),t=O.Constants.authority+O.Constants.resourceDelimeter+e.stateResponse),e.requestType===O.Constants.renewToken){this._acquireTokenInProgress=!1,t=O.Constants.authority+O.Constants.resourceDelimeter+e.stateResponse;var r=null!==this.getUser()?this.getUser().userIdentifier:"";n=O.Constants.acquireTokenUser+O.Constants.resourceDelimeter+r+O.Constants.resourceDelimeter+e.stateResponse}}else if(e.stateMatch){var o;this._logger.info("State is right"),e.parameters.hasOwnProperty(O.Constants.sessionState)&&this._cacheStorage.setItem(O.Constants.msalSessionState,e.parameters[O.Constants.sessionState]);var i="";if(e.parameters.hasOwnProperty(O.Constants.accessToken)){this._logger.info("Fragment has access token"),this._acquireTokenInProgress=!1;var s=void 0;o=e.parameters.hasOwnProperty(O.Constants.idToken)?new d.IdToken(e.parameters[O.Constants.idToken]):new d.IdToken(this._cacheStorage.getItem(O.Constants.idTokenKey)),t=O.Constants.authority+O.Constants.resourceDelimeter+e.stateResponse;var a=this._cacheStorage.getItem(t,this.storeAuthStateInCookie);C.Utils.isEmpty(a)||(a=C.Utils.replaceFirstPath(a,o.tenantId)),s=(e.parameters.hasOwnProperty(O.Constants.clientInfo)?i=e.parameters[O.Constants.clientInfo]:this._logger.warning("ClientInfo not received in the response from AAD"),h.User.createUser(o,new y.ClientInfo(i))),n=O.Constants.acquireTokenUser+O.Constants.resourceDelimeter+s.userIdentifier+O.Constants.resourceDelimeter+e.stateResponse;var c=O.Constants.acquireTokenUser+O.Constants.resourceDelimeter+O.Constants.no_user+O.Constants.resourceDelimeter+e.stateResponse,u=this._cacheStorage.getItem(n),l=void 0;C.Utils.isEmpty(u)?C.Utils.isEmpty(this._cacheStorage.getItem(c))||this.saveAccessToken(a,e,s,i,o):(l=JSON.parse(u),s&&l&&C.Utils.compareObjects(s,l)?(this.saveAccessToken(a,e,s,i,o),this._logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this._logger.warning("The user object created from the response is not the same as the one passed in the acquireToken request"))}if(e.parameters.hasOwnProperty(O.Constants.idToken)){this._logger.info("Fragment has id token"),this._loginInProgress=!1,o=new d.IdToken(e.parameters[O.Constants.idToken]),e.parameters.hasOwnProperty(O.Constants.clientInfo)?i=e.parameters[O.Constants.clientInfo]:this._logger.warning("ClientInfo not received in the response from AAD"),t=O.Constants.authority+O.Constants.resourceDelimeter+e.stateResponse;a=this._cacheStorage.getItem(t,this.storeAuthStateInCookie);C.Utils.isEmpty(a)||(a=C.Utils.replaceFirstPath(a,o.tenantId)),this._user=h.User.createUser(o,new y.ClientInfo(i)),o&&o.nonce?o.nonce!==this._cacheStorage.getItem(O.Constants.nonceIdToken,this.storeAuthStateInCookie)?(this._user=null,this._cacheStorage.setItem(O.Constants.loginError,"Nonce Mismatch. Expected Nonce: "+this._cacheStorage.getItem(O.Constants.nonceIdToken,this.storeAuthStateInCookie)+",Actual Nonce: "+o.nonce),this._logger.error("Nonce Mismatch.Expected Nonce: "+this._cacheStorage.getItem(O.Constants.nonceIdToken,this.storeAuthStateInCookie)+",Actual Nonce: "+o.nonce)):(this._cacheStorage.setItem(O.Constants.idTokenKey,e.parameters[O.Constants.idToken]),this._cacheStorage.setItem(O.Constants.msalClientInfo,i),this.saveAccessToken(a,e,this._user,i,o)):(t=e.stateResponse,n=e.stateResponse,this._logger.error("Invalid id_token received in the response"),e.parameters.error="invalid idToken",e.parameters.error_description="Invalid idToken. idToken: "+e.parameters[O.Constants.idToken],this._cacheStorage.setItem(O.Constants.msalError,"invalid idToken"),this._cacheStorage.setItem(O.Constants.msalErrorDescription,"Invalid idToken. idToken: "+e.parameters[O.Constants.idToken]))}}else t=e.stateResponse,n=e.stateResponse,this._logger.error("State Mismatch.Expected State: "+this._cacheStorage.getItem(O.Constants.stateLogin,this.storeAuthStateInCookie)+",Actual State: "+e.stateResponse),e.parameters.error="Invalid_state",e.parameters.error_description="Invalid_state. state: "+e.stateResponse,this._cacheStorage.setItem(O.Constants.msalError,"Invalid_state"),this._cacheStorage.setItem(O.Constants.msalErrorDescription,"Invalid_state. state: "+e.stateResponse);this._cacheStorage.setItem(O.Constants.renewStatus+e.stateResponse,O.Constants.tokenRenewStatusCompleted),this._cacheStorage.removeAcquireTokenEntries(t,n),this.storeAuthStateInCookie&&(this._cacheStorage.setItemCookie(t,"",-1),this._cacheStorage.clearCookie())},e.prototype.isCallback=function(e){e=this.getHash(e);var t=C.Utils.deserialize(e);return t.hasOwnProperty(O.Constants.errorDescription)||t.hasOwnProperty(O.Constants.error)||t.hasOwnProperty(O.Constants.accessToken)||t.hasOwnProperty(O.Constants.idToken)},e.prototype.getHash=function(e){return-1<e.indexOf("#/")?e=e.substring(e.indexOf("#/")+2):-1<e.indexOf("#")&&(e=e.substring(1)),e},e.prototype.getRequestInfo=function(e){e=this.getHash(e);var t=C.Utils.deserialize(e),n=new s.TokenResponse;if(t&&((n.parameters=t).hasOwnProperty(O.Constants.errorDescription)||t.hasOwnProperty(O.Constants.error)||t.hasOwnProperty(O.Constants.accessToken)||t.hasOwnProperty(O.Constants.idToken))){n.valid=!0;var r=void 0;if(!t.hasOwnProperty("state"))return n;if(r=t.state,(n.stateResponse=r)===this._cacheStorage.getItem(O.Constants.stateLogin,this.storeAuthStateInCookie)||r===this._silentAuthenticationState)return n.requestType=O.Constants.login,n.stateMatch=!0,n;if(r===this._cacheStorage.getItem(O.Constants.stateAcquireToken,this.storeAuthStateInCookie))return n.requestType=O.Constants.renewToken,n.stateMatch=!0,n;if(!n.stateMatch){n.requestType=window.requestType;for(var o=window.renewStates,i=0;i<o.length;i++)if(o[i]===n.stateResponse){n.stateMatch=!0;break}}}return n},e.prototype.getScopeFromState=function(e){if(e){var t=e.indexOf("|");if(-1<t&&t+1<e.length)return e.substring(t+1)}return""},e.prototype.getUserState=function(e){if(e){var t=e.indexOf("|");if(-1<t&&t+1<e.length)return e.substring(t+1)}return""},e.prototype.isInIframe=function(){return window.parent!==window},e.prototype.loginInProgress=function(){return!!this._cacheStorage.getItem(O.Constants.urlHash)||this._loginInProgress},e.prototype.getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t=t.split("/")[0]},e.prototype.getScopesForEndpoint=function(e){if(0<this._unprotectedResources.length)for(var t=0;t<this._unprotectedResources.length;t++)if(-1<e.indexOf(this._unprotectedResources[t]))return null;if(0<this._protectedResourceMap.size)for(var n=0,r=Array.from(this._protectedResourceMap.keys());n<r.length;n++){var o=r[n];if(-1<e.indexOf(o))return this._protectedResourceMap.get(o)}return-1<e.indexOf("http://")||-1<e.indexOf("https://")?this.getHostFromUri(e)===this.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},e.prototype.setloginInProgress=function(e){this._loginInProgress=e},e.prototype.getAcquireTokenInProgress=function(){return this._acquireTokenInProgress},e.prototype.setAcquireTokenInProgress=function(e){this._acquireTokenInProgress=e},e.prototype.getLogger=function(){return this._logger},r.__decorate([o],e.prototype,"acquireTokenSilent",null),e}();t.UserAgentApplication=i},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){this.valid=!1,this.parameters={},this.stateMatch=!1,this.stateResponse="",this.requestType="unknown"};t.TokenResponse=r},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),r=function(){function i(e,t,n,r,o,i){this.displayableId=e,this.name=t,this.identityProvider=n,this.userIdentifier=r,this.idToken=o,this.sid=i}return i.createUser=function(e,t){var n,r;r=t?(n=t.uid,t.utid):n="";var o=s.Utils.base64EncodeStringUrlSafe(n)+"."+s.Utils.base64EncodeStringUrlSafe(r);return new i(e.preferredName,e.name,e.issuer,o,e.decodedIdToken,e.sid)},i}();t.User=r},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(2),i=n(10),s=function(n){function t(e,t){return n.call(this,e,t)||this}return r.__extends(t,n),Object.defineProperty(t.prototype,"AadInstanceDiscoveryEndpointUrl",{get:function(){return t.AadInstanceDiscoveryEndpoint+"?api-version=1.0&authorization_endpoint="+this.CanonicalAuthority+"oauth2/v2.0/authorize"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AuthorityType",{get:function(){return o.AuthorityType.Aad},enumerable:!0,configurable:!0}),t.prototype.GetOpenIdConfigurationEndpointAsync=function(){var n=this,e=new Promise(function(e,t){return e(n.DefaultOpenIdConfigurationEndpoint)});if(!this.IsValidationEnabled)return e;var t=this.CanonicalAuthorityUrlComponents.HostNameAndPort;return this.IsInTrustedHostList(t)?e:(new i.XhrClient).sendRequestAsync(this.AadInstanceDiscoveryEndpointUrl,"GET",!0).then(function(e){return e.tenant_discovery_endpoint})},t.prototype.IsInTrustedHostList=function(e){return t.TrustedHostList[e.toLowerCase()]},t.AadInstanceDiscoveryEndpoint="https://login.microsoftonline.com/common/discovery/instance",t.TrustedHostList={"login.windows.net":"login.windows.net","login.chinacloudapi.cn":"login.chinacloudapi.cn","login.cloudgovapi.us":"login.cloudgovapi.us","login.microsoftonline.com":"login.microsoftonline.com","login.microsoftonline.de":"login.microsoftonline.de","login.microsoftonline.us":"login.microsoftonline.us"},t}(o.Authority);t.AadAuthority=s},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.sendRequestAsync=function(e,t,n){var i=this;return new Promise(function(n,r){var o=new XMLHttpRequest;if(o.open(t,e,!0),o.onload=function(e){(o.status<200||300<=o.status)&&r(i.handleError(o.responseText));try{var t=JSON.parse(o.responseText)}catch(e){r(i.handleError(o.responseText))}n(t)},o.onerror=function(e){r(o.status)},"GET"!==t)throw"not implemented";o.send()})},e.prototype.handleError=function(t){var e;try{if((e=JSON.parse(t)).error)return e.error;throw t}catch(e){return t}},e}();t.XhrClient=r},function(e,t,n){e.exports=n(12)},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(6);t.UserAgentApplication=r.UserAgentApplication;var o=n(4);t.Logger=o.Logger;var i=n(4);t.LogLevel=i.LogLevel;var s=n(8);t.User=s.User;var a=n(1);t.Constants=a.Constants;var c=n(7);t.TokenResponse=c.TokenResponse;var u=n(2);t.Authority=u.Authority;var l=n(6);t.CacheResult=l.CacheResult},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=function(e,t,n,r,o){this.authority=e,this.clientId=t,this.scopes=n,this.userIdentifier=i.Utils.base64EncodeStringUrlSafe(r)+"."+i.Utils.base64EncodeStringUrlSafe(o)};t.AccessTokenKey=r},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,n,r){this.accessToken=e,this.idToken=t,this.expiresIn=n,this.clientInfo=r};t.AccessTokenValue=r},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),r=function(){function e(e,t,n,r,o,i){this.authorityInstance=e,this.clientId=t,this.scopes=n,this.responseType=r,this.redirectUri=o,this.correlationId=s.Utils.createNewGuid(),this.state=i&&!s.Utils.isEmpty(i)?s.Utils.createNewGuid()+"|"+i:s.Utils.createNewGuid(),this.nonce=s.Utils.createNewGuid(),this.xClientSku="MSAL.JS",this.xClientVer=s.Utils.getLibraryVersion()}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!0,configurable:!0}),e.prototype.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),n=this.authorityInstance.AuthorizationEndpoint;return n.indexOf("?")<0?n+="?":n+="&",""+n+t.join("&")},e.prototype.createNavigationUrlString=function(e){e||(e=[this.clientId]),-1===e.indexOf(this.clientId)&&e.push(this.clientId);var t=[];return t.push("response_type="+this.responseType),this.translateclientIdUsedInScope(e),t.push("scope="+encodeURIComponent(this.parseScope(e))),t.push("client_id="+encodeURIComponent(this.clientId)),t.push("redirect_uri="+encodeURIComponent(this.redirectUri)),t.push("state="+encodeURIComponent(this.state)),t.push("nonce="+encodeURIComponent(this.nonce)),t.push("client_info=1"),t.push("x-client-SKU="+this.xClientSku),t.push("x-client-Ver="+this.xClientVer),this.extraQueryParameters&&t.push(this.extraQueryParameters),t.push("client-request-id="+encodeURIComponent(this.correlationId)),t},e.prototype.translateclientIdUsedInScope=function(e){var t=e.indexOf(this.clientId);0<=t&&(e.splice(t,1),-1===e.indexOf("openid")&&e.push("openid"),-1===e.indexOf("profile")&&e.push("profile"))},e.prototype.parseScope=function(e){var t="";if(e)for(var n=0;n<e.length;++n)t+=n!==e.length-1?e[n]+" ":e[n];return t},e}();t.AuthenticationRequestParameters=r},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(){function e(e){if(!e||r.Utils.isEmpty(e))return this.uid="",void(this.utid="");try{var t=r.Utils.base64DecodeStringUrlSafe(e),n=JSON.parse(t);n&&(n.hasOwnProperty("uid")&&(this.uid=n.uid),n.hasOwnProperty("utid")&&(this.utid=n.utid))}catch(e){throw new Error(e)}}return Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!0,configurable:!0}),e}();t.ClientInfo=o},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(e){if(r.Utils.isEmpty(e))throw new Error("null or empty raw idtoken");try{this.rawIdToken=e,this.decodedIdToken=r.Utils.extractIdToken(e),this.decodedIdToken&&(this.decodedIdToken.hasOwnProperty("iss")&&(this.issuer=this.decodedIdToken.iss),this.decodedIdToken.hasOwnProperty("oid")&&(this.objectId=this.decodedIdToken.oid),this.decodedIdToken.hasOwnProperty("sub")&&(this.subject=this.decodedIdToken.sub),this.decodedIdToken.hasOwnProperty("tid")&&(this.tenantId=this.decodedIdToken.tid),this.decodedIdToken.hasOwnProperty("ver")&&(this.version=this.decodedIdToken.ver),this.decodedIdToken.hasOwnProperty("preferred_username")&&(this.preferredName=this.decodedIdToken.preferred_username),this.decodedIdToken.hasOwnProperty("name")&&(this.name=this.decodedIdToken.name),this.decodedIdToken.hasOwnProperty("nonce")&&(this.nonce=this.decodedIdToken.nonce),this.decodedIdToken.hasOwnProperty("exp")&&(this.expiration=this.decodedIdToken.exp),this.decodedIdToken.hasOwnProperty("home_oid")&&(this.homeObjectId=this.decodedIdToken.home_oid),this.decodedIdToken.hasOwnProperty("sid")&&(this.sid=this.decodedIdToken.sid))}catch(e){throw new Error("Failed to parse the returned id token")}};t.IdToken=o},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(19),o=function(){function t(e){if(t._instance)return t._instance;if(this._cacheLocation=e,this._localStorageSupported=void 0!==window[this._cacheLocation]&&null!=window[this._cacheLocation],this._sessionStorageSupported=void 0!==window[e]&&null!=window[e],!(t._instance=this)._localStorageSupported&&!this._sessionStorageSupported)throw new Error("localStorage and sessionStorage not supported");return t._instance}return t.prototype.setItem=function(e,t,n){window[this._cacheLocation]&&window[this._cacheLocation].setItem(e,t),n&&this.setItemCookie(e,t)},t.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this._cacheLocation]?window[this._cacheLocation].getItem(e):null},t.prototype.removeItem=function(e){if(window[this._cacheLocation])return window[this._cacheLocation].removeItem(e)},t.prototype.clear=function(){if(window[this._cacheLocation])return window[this._cacheLocation].clear()},t.prototype.getAllAccessTokens=function(e,t){var n,r=[],o=window[this._cacheLocation];if(o){var i=void 0;for(i in o)if(o.hasOwnProperty(i)&&i.match(e)&&i.match(t)){var s=this.getItem(i);s&&(n=new a.AccessTokenCacheItem(JSON.parse(i),JSON.parse(s)),r.push(n))}}return r},t.prototype.removeAcquireTokenEntries=function(e,t){var n=window[this._cacheLocation];if(n){var r=void 0;for(r in n)n.hasOwnProperty(r)&&(""!==e&&-1<r.indexOf(e)||""!==t&&-1<r.indexOf(t))&&this.removeItem(r)}},t.prototype.resetCacheItems=function(){var e=window[this._cacheLocation];if(e){var t=void 0;for(t in e)e.hasOwnProperty(t)&&(-1!==t.indexOf(r.Constants.msal)&&this.setItem(t,""),-1!==t.indexOf(r.Constants.renewStatus)&&this.removeItem(t))}},t.prototype.setItemCookie=function(e,t,n){var r=e+"="+t+";";n&&(r+="expires="+this.setExpirationCookie(n)+";");document.cookie=r},t.prototype.getItemCookie=function(e){for(var t=e+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var o=n[r];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return""},t.prototype.setExpirationCookie=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3).toUTCString()},t.prototype.clearCookie=function(){this.setItemCookie(r.Constants.nonceIdToken,"",-1),this.setItemCookie(r.Constants.stateLogin,"",-1),this.setItemCookie(r.Constants.loginRequest,"",-1),this.setItemCookie(r.Constants.stateAcquireToken,"",-1)},t}();t.Storage=o},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){this.key=e,this.value=t};t.AccessTokenCacheItem=r},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(9),i=n(21),s=n(2),a=n(5),c=function(){function n(){}return n.DetectAuthorityFromUrl=function(e){switch(e=r.Utils.CanonicalizeUri(e),r.Utils.GetUrlComponents(e).PathSegments[0]){case"tfp":return s.AuthorityType.B2C;case"adfs":return s.AuthorityType.Adfs;default:return s.AuthorityType.Aad}},n.CreateInstance=function(e,t){if(r.Utils.isEmpty(e))return null;switch(n.DetectAuthorityFromUrl(e)){case s.AuthorityType.B2C:return new i.B2cAuthority(e,t);case s.AuthorityType.Aad:return new o.AadAuthority(e,t);default:throw a.ErrorMessage.invalidAuthorityType}},n}();t.AuthorityFactory=c},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(9),s=n(2),a=n(5),c=n(0),i=function(i){function e(e,t){var n=i.call(this,e,t)||this,r=c.Utils.GetUrlComponents(e),o=r.PathSegments;if(o.length<3)throw a.ErrorMessage.b2cAuthorityUriInvalidPath;return n.CanonicalAuthority="https://"+r.HostNameAndPort+"/"+o[0]+"/"+o[1]+"/"+o[2]+"/",n}return r.__extends(e,i),Object.defineProperty(e.prototype,"AuthorityType",{get:function(){return s.AuthorityType.B2C},enumerable:!0,configurable:!0}),e.prototype.GetOpenIdConfigurationEndpointAsync=function(){var n=this,e=new Promise(function(e,t){return e(n.DefaultOpenIdConfigurationEndpoint)});return this.IsValidationEnabled?this.IsInTrustedHostList(this.CanonicalAuthorityUrlComponents.HostNameAndPort)?e:new Promise(function(e,t){return t(a.ErrorMessage.unsupportedAuthorityValidation)}):e},e}(o.AadAuthority);t.B2cAuthority=i}])});